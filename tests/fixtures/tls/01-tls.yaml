---
# Single-node deployment with TLS mixed mode
# Tests: Basic deployment with TLS using inline cert + secret refs, no keeper, minimal config
# Expected pods: 1 ClickHouse
clickhouse:
  replicasCount: 1
  shardsCount: 1
  
  defaultUser:
    password: "TestTLSPassword123"
    allowExternalAccess: true
  
  persistence:
    enabled: true
    size: 2Gi
    accessMode: ReadWriteOnce
  
  service:
    type: ClusterIP
  
  tls:
    enabled: true
    
    certificateFile:
      configFileName: foo.crt
      inlineFileContent: |
        -----BEGIN CERTIFICATE-----
        MIIDUTCCAjmgAwIBAgIUDhCxWuuYVzPa4GqNNvchTlbogwYwDQYJKoZIhvcNAQEL
        BQAwNzE1MDMGA1UEAwwsdDAxLXRscy1jbGlja2hvdXNlLnQwMS10bHMuc3ZjLmNs
        dXN0ZXIubG9jYWwwIBcNMjYwMjExMDEyNTA0WhgPMjA1NjAyMDQwMTI1MDRaMDcx
        NTAzBgNVBAMMLHQwMS10bHMtY2xpY2tob3VzZS50MDEtdGxzLnN2Yy5jbHVzdGVy
        LmxvY2FsMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAi8a6ln0VHcMs
        LVH/7uFtTJIphIhg6d9lAGd+QxXIsEN2nVZf1qykksRprM7StTiXRiOqcuydyS4H
        Gas47PN40D7wTEGQ8QA1H+ZE4whzBeGt0U7exYfZqZWdwcVTGynCAOFtknTN9U21
        CjRD8m2FNYaphb7gdsOfM5ZaRSjbehlwKXIQtNuFCK3GCuw5TIMhxHZk1p7fK55U
        CgoXXZ8fhKazvkUu/DCVS5ZTcXWUkqv9Tuc/EF2XoJj+w9chOi/YtybCVAt5sJyG
        NUHeQS88olEE+ZbQPKuv0hHLITFTep9h3Owl1k4dj+o4HQPDjapeiWR/Yvmboa1b
        cQWGeozlKwIDAQABo1MwUTAdBgNVHQ4EFgQUMz4g29Owh+XSlm+cWGtT6Brc+OYw
        HwYDVR0jBBgwFoAUMz4g29Owh+XSlm+cWGtT6Brc+OYwDwYDVR0TAQH/BAUwAwEB
        /zANBgkqhkiG9w0BAQsFAAOCAQEAEDfO4htKuHJCvtL2H3BE0FnH3HdZKcOy3hGi
        Ol20fZ9cq5FxkDRTCd0dUVwiiJj/2Op7ZjEBoMD1L1iENKQlgK1WCsP3M9xsCa83
        xNwu6oY74YWoyXPx54/MWIo53s7ltRQX/6fmgWdPB2r8fi5Or4lI+71m0Uo0cOZI
        loqQk6cRS6OibzIIz+ejrIWV51h+jCRLzN3IC9R95TlSy6J+0iEVxCDruMEbMxI8
        J5/t0gqNjb52lcTUZ1MyvPWvrC1i0UePi1752fvjgFI3Q1S2wK6drOUN2jHCsIt4
        JSPST1w6EiAIi2AhblMcLQRhcJ+7o5KcMQcWb8MCFMvRPtdIhA==
        -----END CERTIFICATE-----
    
    privateKeyFile:
      configFileName: bar.key
      secretReference:
        name: clickhouse-certs
        key: server.key
    
    dhParamsFile:
      configFileName: dhparam.pem
      secretReference:
        name: clickhouse-certs
        key: dhparam.pem
    
    opensslConfig: |
      <clickhouse>
        <openSSL>
          <server>
            <certificateFile>/etc/clickhouse-server/config.d/foo.crt</certificateFile>
            <privateKeyFile>/etc/clickhouse-server/secrets.d/bar.key/clickhouse-certs/server.key</privateKeyFile>
            <dhParamsFile>/etc/clickhouse-server/secrets.d/dhparam.pem/clickhouse-certs/dhparam.pem</dhParamsFile>
            <verificationMode>relaxed</verificationMode>
            <loadDefaultCAFile>true</loadDefaultCAFile>
            <cacheSessions>true</cacheSessions>
            <disableProtocols>sslv2,sslv3</disableProtocols>
            <preferServerCiphers>true</preferServerCiphers>
          </server>
        </openSSL>
      </clickhouse>

keeper:
  enabled: false

operator:
  enabled: true


